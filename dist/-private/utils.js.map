{"version":3,"file":"utils.js","sources":["../../src/-private/utils.ts"],"sourcesContent":["import _isNil from 'lodash/isNil';\n\nimport type { FormatOptions } from '../types';\n\nexport const inputUtils = (\n  input: Element,\n): {\n  setAttribute: (attribute: string, value: string | number | undefined | boolean) => void;\n  isFormInput: boolean;\n  isInput: boolean;\n  isTextarea: boolean;\n  isSelect: boolean;\n  isCheckbox: boolean;\n  isRadio: boolean;\n  name: string | null;\n} => {\n  return {\n    setAttribute: (attribute: string, value: string | number | undefined | boolean): void => {\n      if (_isNil(value) || !`${value}`.trim()) {\n        input.removeAttribute(attribute);\n      } else {\n        input.setAttribute(attribute, `${value}`);\n      }\n    },\n    isFormInput: ['INPUT', 'SELECT', 'TEXTAREA'].includes(input.tagName),\n    isInput: input.tagName === 'INPUT',\n    isTextarea: input.tagName === 'TEXTAREA',\n    isSelect: input.tagName === 'SELECT',\n    isCheckbox: (input as HTMLInputElement).type === 'checkbox',\n    isRadio: (input as HTMLInputElement).type === 'radio',\n    name: input.getAttribute('name'),\n  };\n};\n\nexport const valueIfChecked = (event: Event, value?: any, defaultValue?: any) => {\n  const target = event.target as HTMLInputElement;\n  const { isCheckbox, isRadio } = inputUtils(target);\n  const isCheckable = isCheckbox || isRadio;\n  const arrayByDefault = Array.isArray(defaultValue) || _isNil(defaultValue);\n  const checkboxSet = new Set(Array.isArray(value) ? value : []);\n\n  if (!isCheckable || (isCheckable && !!target.checked)) {\n    if (isCheckbox) {\n      checkboxSet.add(target.value);\n\n      return arrayByDefault ? [...checkboxSet] : target.value;\n    }\n\n    return target.value;\n  }\n\n  if (isCheckbox && !target.checked) {\n    checkboxSet.delete(target.value);\n\n    return arrayByDefault\n      ? _isNil(defaultValue) && checkboxSet.size === 0\n        ? undefined\n        : [...checkboxSet]\n      : undefined;\n  }\n\n  return undefined;\n};\n\nexport const formatValue = (value: any, formatOptions: FormatOptions | undefined): any => {\n  if (!formatOptions) {\n    return value;\n  }\n\n  const { valueAsNumber, valueAsDate, valueFormat, valueAsBoolean } = formatOptions;\n\n  if (valueFormat) {\n    return valueFormat(value);\n  }\n\n  if (valueAsNumber) {\n    return +(value as string | number);\n  }\n\n  if (valueAsDate) {\n    return new Date(value as string | number);\n  }\n\n  if (valueAsBoolean) {\n    return Boolean(value);\n  }\n\n  return value;\n};\n"],"names":["inputUtils","input","setAttribute","attribute","value","_isNil","trim","removeAttribute","isFormInput","includes","tagName","isInput","isTextarea","isSelect","isCheckbox","type","isRadio","name","getAttribute","valueIfChecked","event","defaultValue","target","isCheckable","arrayByDefault","Array","isArray","checkboxSet","Set","checked","add","delete","size","undefined","formatValue","formatOptions","valueAsNumber","valueAsDate","valueFormat","valueAsBoolean","Date","Boolean"],"mappings":"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"}